import{b as k,am as b,as as F,bU as V,aj as c,j as e,G as s,ak as j,r as t,d as E,C as K,al as P,bn as O}from"./index-BkjFfd7S.js";import{D as Q}from"./manage-MeHYtyNQ.js";/* empty css                */import{u as I,c as R,b as d}from"./index.esm-BcbAVVWb.js";import{a as m,I as u,b as g,F as x}from"./InputLabel-PnYLoR_E.js";import{T as X}from"./TextField-Cf-4O8qQ.js";import{P as z}from"./Pagination-D-s-QI-l.js";import"./Select-6NCDCthj.js";import"./Close-_StmtKkt.js";import"./Chip-BzMFiD_F.js";import"./Stack-Csv26LgQ.js";function J({handleClose:l,pageIndex:T}){const o=k(),i=I({initialValues:{hinhAnh:"",quocGia:"",tenViTri:"",tinhThanh:""},validationSchema:R().shape({hinhAnh:d().required("This field have to be filled"),quocGia:d().required("This field have to be filled").matches(b.nameByVietnamese,"Invalid value!"),tenViTri:d().required("This field have to be filled").matches(b.nameByVietnamese,"Invalid value!"),tinhThanh:d().required("This field have to be filled").matches(b.nameByVietnamese,"Invalid value!")}),onSubmit:async v=>{try{await F.post("/api/vi-tri",v),o(V({pageIndex:T,keywords:""})),c("Thành công thêm mới vị trí",{icon:"success"}),l()}catch(h){console.log(h),c("Thất bại thêm mới vị trí, vui lòng kiểm tra lại thông tin!",{icon:"error"})}}});return e.jsx("div",{className:"add-location-modal",children:e.jsxs("form",{action:"",className:"admin-register-form",onSubmit:i.handleSubmit,children:[e.jsx("h1",{children:"Thêm vị trí"}),e.jsxs(s,{container:!0,spacing:2,className:"mui-grid-container-room",children:[e.jsx(s,{item:!0,lg:6,className:"mui-grid-item-room",children:e.jsxs(m,{variant:"standard",className:"mui-form-control-admin",margin:"dense",error:!!i.errors.tenViTri,children:[e.jsx(u,{htmlFor:"tenViTri",children:"Tên vị trí"}),e.jsx(g,{id:"tenViTri","aria-describedby":"my-helper-text",...i.getFieldProps("tenViTri")}),i.errors.tenViTri&&i.touched?e.jsx(x,{children:i.errors.tenViTri}):e.jsx(e.Fragment,{})]})}),e.jsx(s,{item:!0,lg:6,className:"mui-grid-item-room",children:e.jsxs(m,{variant:"standard",className:"mui-form-control-admin",margin:"dense",error:!!i.errors.tinhThanh,children:[e.jsx(u,{htmlFor:"tinhThanh",children:"Tỉnh thành"}),e.jsx(g,{id:"tinhThanh","aria-describedby":"my-helper-text",...i.getFieldProps("tinhThanh")}),i.errors.tinhThanh&&i.touched?e.jsx(x,{children:i.errors.tinhThanh}):e.jsx(e.Fragment,{})]})}),e.jsx(s,{item:!0,lg:6,className:"mui-grid-item-room",children:e.jsxs(m,{variant:"standard",className:"mui-form-control-admin",margin:"dense",error:!!i.errors.quocGia,children:[e.jsx(u,{htmlFor:"quocGia",children:"Quốc gia"}),e.jsx(g,{id:"quocGia","aria-describedby":"my-helper-text",...i.getFieldProps("quocGia")}),i.errors.quocGia&&i.touched?e.jsx(x,{children:i.errors.quocGia}):e.jsx(e.Fragment,{})]})}),e.jsx(s,{item:!0,lg:6,className:"mui-grid-item-room",children:e.jsxs(m,{variant:"standard",className:"mui-form-control-admin",margin:"dense",error:!!i.errors.hinhAnh,children:[e.jsx(u,{htmlFor:"hinhAnh",children:"Hình ảnh"}),e.jsx(g,{id:"hinhAnh","aria-describedby":"my-helper-text",...i.getFieldProps("hinhAnh")}),i.errors.hinhAnh&&i.touched?e.jsx(x,{children:i.errors.hinhAnh}):e.jsx(e.Fragment,{})]})})]}),e.jsxs("div",{className:"button-group-admin-room",children:[e.jsx(j,{variant:"contained",type:"submit",children:"Thêm"}),e.jsx(j,{variant:"contained",onClick:l,children:"Hủy"})]})]})})}function W({handleClose:l,id:T,data:o,pageIndex:i}){const v=k(),[h,y]=t.useState(null),[N,f]=t.useState();t.useEffect(()=>{if(!h){f(void 0);return}const a=URL.createObjectURL(h);return f(a),()=>URL.revokeObjectURL(a)},[h]);const A=a=>{a.target.files!==null&&y(a.target.files[0])},r=I({initialValues:{hinhAnh:`${o.hinhAnh}`,quocGia:`${o.quocGia}`,tenViTri:`${o.tenViTri}`,tinhThanh:`${o.tinhThanh}`},validationSchema:R().shape({hinhAnh:d().required("This field have to be filled"),quocGia:d().required("This field have to be filled").matches(b.nameByVietnamese,"Invalid value!"),tenViTri:d().required("This field have to be filled"),tinhThanh:d().required("This field have to be filled").matches(b.nameByVietnamese,"Invalid value!")}),onSubmit:async a=>{try{if(await F.put(`/api/vi-tri/${T}`,a),h!==null){const p=new FormData;p.append("formFile",h),await F.post(`/api/vi-tri/upload-hinh-vitri?maViTri=${o.id}`,p)}v(V({pageIndex:i,keywords:""})),c(`Thành công cập nhật vị trí ${a.tenViTri}`,{icon:"success"}),l()}catch(p){console.log(p),c("Thất bại cập nhật vị trí, vui lòng kiểm tra lại thông tin!",{icon:"error"})}}});return e.jsx("div",{className:"update-location-modal",children:e.jsxs("form",{action:"",className:"admin-register-form",onSubmit:r.handleSubmit,children:[e.jsx("h1",{children:"Sửa vị trí"}),e.jsxs(s,{container:!0,spacing:2,className:"mui-grid-container-room",children:[e.jsx(s,{item:!0,lg:6,className:"mui-grid-item-room",children:e.jsxs(m,{variant:"standard",className:"mui-form-control-admin",margin:"dense",error:!!r.errors.tenViTri,children:[e.jsx(u,{htmlFor:"tenViTri",children:"Tên vị trí"}),e.jsx(g,{id:"tenViTri","aria-describedby":"my-helper-text",...r.getFieldProps("tenViTri")}),r.errors.tenViTri&&r.touched?e.jsx(x,{children:r.errors.tenViTri}):e.jsx(e.Fragment,{})]})}),e.jsx(s,{item:!0,lg:6,className:"mui-grid-item-room",children:e.jsxs(m,{variant:"standard",className:"mui-form-control-admin",margin:"dense",error:!!r.errors.tinhThanh,children:[e.jsx(u,{htmlFor:"tinhThanh",children:"Tỉnh thành"}),e.jsx(g,{id:"tinhThanh","aria-describedby":"my-helper-text",...r.getFieldProps("tinhThanh")}),r.errors.tinhThanh&&r.touched?e.jsx(x,{children:r.errors.tinhThanh}):e.jsx(e.Fragment,{})]})}),e.jsx(s,{item:!0,lg:6,className:"mui-grid-item-room",children:e.jsxs(m,{variant:"standard",className:"mui-form-control-admin",margin:"dense",error:!!r.errors.quocGia,children:[e.jsx(u,{htmlFor:"quocGia",children:"Quốc gia"}),e.jsx(g,{id:"quocGia","aria-describedby":"my-helper-text",...r.getFieldProps("quocGia")}),r.errors.quocGia&&r.touched?e.jsx(x,{children:r.errors.quocGia}):e.jsx(e.Fragment,{})]})}),e.jsx(s,{item:!0,lg:6,className:"mui-grid-item-room",children:e.jsxs(m,{variant:"standard",className:"mui-form-control-admin",margin:"dense",error:!!r.errors.hinhAnh,children:[e.jsx(u,{htmlFor:"hinhAnh",children:"Hình ảnh"}),e.jsx(g,{id:"hinhAnh","aria-describedby":"my-helper-text",...r.getFieldProps("hinhAnh")}),r.errors.hinhAnh&&r.touched?e.jsx(x,{children:r.errors.hinhAnh}):e.jsx(e.Fragment,{})]})}),e.jsxs(s,{item:!0,lg:6,className:"mui-grid-item-room",children:[e.jsx("img",{src:N||r.values.hinhAnh,alt:""}),e.jsx("input",{type:"file",onChange:A})]})]}),e.jsxs("div",{className:"button-group-admin-room",children:[e.jsx(j,{variant:"contained",color:"info",type:"submit",children:"Sửa"}),e.jsx(j,{variant:"contained",color:"warning",onClick:l,children:"Hủy"})]})]})})}function he(){const l=k(),[T,o]=t.useState(!1),[i,v]=t.useState(1),h=()=>o(!0),y=()=>o(!1),[N,f]=t.useState(!1),[A,r]=t.useState(),[a,p]=t.useState(""),C=t.useRef(),[$,L]=t.useState({id:-1,hinhAnh:"",quocGia:"",tenViTri:"",tinhThanh:""}),B=[{field:"id",headerName:"Mã",width:70,align:"center",headerAlign:"center"},{field:"tenViTri",headerName:"Tên vị trí",width:200,align:"center",headerAlign:"center"},{field:"hinhAnh",headerName:"Hình ảnh",width:180,align:"center",headerAlign:"center",renderCell:n=>e.jsx(O,{alt:"Remy Sharp",src:n.row.hinhAnh})},{field:"tinhThanh",headerName:"Tỉnh thành",width:100,align:"center",headerAlign:"center"},{field:"quocGia",headerName:"Quốc gia",width:100,align:"center",headerAlign:"center"},{field:"action",headerName:"Action",width:300,sortable:!1,align:"center",headerAlign:"center",renderCell:n=>{const q=S=>{S.stopPropagation(),f(!0),r(n.row.id),L(n.row)},M=S=>{S.stopPropagation();try{c({title:"Bạn có chắc chắn muốn xóa địa điểm này?",text:"Không thể quay lại sau khi xóa",icon:"warning",buttons:["Không xóa","Xóa!"],dangerMode:!0}).then(function(G){G?c({title:"Xóa thành công!",text:`Người địa điểm với tên ${n.row.tenViTri} đã bị xóa`,icon:"success"}).then(async()=>{await F.delete(`/api/vi-tri/${n.row.id}`),l(V({pageIndex:i,keywords:""}))}):c("Hủy thành công",`Vị trí ${n.row.tenViTri} chưa bị xóa`,"error")})}catch(G){console.log(G),c("Thất bại, xóa thất bại!",{icon:"error"})}};return e.jsxs("div",{className:"button-group",children:[e.jsx(j,{variant:"contained",onClick:q,color:"info",children:"Sửa"}),e.jsx(j,{variant:"contained",onClick:M,color:"error",children:"Xóa"})]})}}],H=[{id:1,tenViTri:"Quận 1",tinhThanh:"Hồ Chí Minh",quocGia:"Việt Nam",hinhAnh:"https://airbnbnew.cybersoft.edu.vn/images/vt1.jpg"}],w=E(n=>n.sliceLocationAdmin.currentLocationbyPhanTrang),D=w.data?w.data:H;t.useEffect(()=>{l(V({pageIndex:i,keywords:a}))},[i,a]);const U=(n,q)=>(v(q),n.target);return e.jsx("div",{className:"manage-location",children:e.jsxs(K,{fixed:!0,className:"mui-container-manage",children:[e.jsx(j,{className:"button-add-admin",onClick:h,children:"Thêm mới vị trí"}),e.jsxs("div",{className:"search-user",children:[e.jsx(X,{inputRef:C,id:"outlined-basic",label:"Tìm theo tên",variant:"outlined",className:"input-search"}),e.jsx("button",{onClick:()=>{const n=C.current;p(n.value)},children:"Tìm"})]}),e.jsx(P,{open:T,onClose:y,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsx(J,{handleClose:y,pageIndex:i})}),e.jsx(P,{open:N,onClose:()=>{f(!1)},"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsx(W,{handleClose:()=>{f(!1)},id:A,pageIndex:i,data:$})}),e.jsx(Q,{className:"mui-grid-user",rows:D,columns:B,checkboxSelection:!0,hideFooterPagination:!0,hideFooter:!0,sx:{fontSize:"1.4rem",height:475}}),e.jsx(z,{onChange:U,count:Math.ceil(w.totalRow/w.pageSize),variant:"outlined",sx:{marginTop:"1rem",marginRight:"5%",justifyContent:"flex-end",display:"flex"}})]})})}export{he as default};

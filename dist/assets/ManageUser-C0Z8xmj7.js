import{r as d,am as $,ah as A,aj as C,j as e,G as m,B as G,aq as F,ak as g,aD as R,b as T,bl as K,d as X,bm as W,C as Q,al as M,bn as D,bo as _}from"./index-Dq6x1obF.js";import{u as I,c as U,b as w,d as J,a as q}from"./index.esm-BTVOpGtT.js";import{a as u,I as x,b,F as f}from"./InputLabel-DV1Dl-od.js";import{L as O,A as B,D as E}from"./DatePicker-B6rC2A4h.js";import{D as z}from"./DemoContainer-Sly3XFDJ.js";import{S as H}from"./Select-BtoazZwA.js";import{C as Y,a as Z,b as V,c as ee}from"./CardMedia-JuuGkclV.js";import{T as L}from"./TextField-C8W0bcOd.js";import{D as re}from"./manage-B8Gz_072.js";import{P as ae}from"./Pagination-AG0kA8X4.js";import"./DialogContent-DjOPT0Q2.js";import"./Chip-UL-Qs_k6.js";import"./Stack-DmnFc82M.js";import"./Close-Cavapc2l.js";function se({handleCloseModal:n}){const[i,j]=d.useState(!1),[s,a]=d.useState(null),[o,h]=d.useState(),[p,c]=d.useState();let l=`${s==null?void 0:s.date()}-${((s==null?void 0:s.month())||0)+1}-${s==null?void 0:s.year()}`,v=o==="true"?!0:o==="false"?!1:"";const y=()=>{j(!1)},S=()=>{j(!0)},t=N=>{h(N.target.value)};d.useEffect(()=>{l=`${s==null?void 0:s.date()}-${((s==null?void 0:s.month())||0)+1}-${s==null?void 0:s.year()}`,v=o==="true"?!0:o==="false"?!1:"",c(!(l==="undefined-1-undefined"||v===""))},[l,o]);const r=I({initialValues:{user:"",password:"",checkPassword:"",name:"",email:"",phone:"",birthday:"",role:"",gender:!0},validationSchema:U().shape({user:w().min(6,"Min is 6 characters").max(12,"Max is 12 characters").required("User can not be empty"),password:w().required("Password can not be empty").min(6,"Min is 6 characters").max(12,"Max is 12 characters").matches($.password,"password must contain at least 1 digit, 1 special character, 1 alphabeltic character !"),checkPassword:w().required("Please confirm your password").oneOf([J("password")],"Passwords must match!"),name:w().matches($.nameByVietnamese,"Name has to be valid").required("Name can not be empty"),email:w().email("This field has to be email").required("Email can not be empty"),phone:q().required("Phone can not be empty")}),onSubmit:async N=>{try{if(p){const k={...N,birthday:l,role:"ADMIN",gender:v};await A.post("/api/users",k),n(),C("Thành công, tài khoản đã được tạo!",{icon:"success"})}}catch(k){console.log(k),C("Thất bại, email đã được dùng!",{icon:"error"})}}});return e.jsx("div",{className:"admin-register",children:e.jsxs("form",{action:"",className:"admin-register-form",onSubmit:r.handleSubmit,children:[e.jsx("h1",{className:"header",children:"Form Đăng Ký Admin"}),e.jsxs(m,{container:!0,spacing:2,className:"mui-grid-admin",children:[e.jsx(m,{item:!0,lg:6,className:"mui-item-grid-admin",children:e.jsxs(u,{variant:"standard",className:"mui-form-control-admin",margin:"dense",error:!!r.errors.user,children:[e.jsx(x,{htmlFor:"my-input-account",children:"Tài khoản"}),e.jsx(b,{id:"my-input-account","aria-describedby":"my-helper-text",...r.getFieldProps("user")}),r.touched.user&&r.errors.user?e.jsx(f,{id:"my-helper-text",children:r.errors.user}):e.jsx(e.Fragment,{})]})}),e.jsx(m,{item:!0,lg:6,className:"mui-item-grid-admin",children:e.jsxs(u,{variant:"standard",className:"mui-form-control-admin",margin:"dense",error:!!r.errors.password,children:[e.jsx(x,{htmlFor:"my-input-password",children:"Mật khẩu"}),e.jsx(b,{id:"my-input-password","aria-describedby":"my-helper-text",...r.getFieldProps("password")}),r.touched.password&&r.errors.password?e.jsx(f,{id:"my-helper-text",children:r.errors.password}):e.jsx(e.Fragment,{})]})}),e.jsx(m,{item:!0,lg:6,className:"mui-item-grid-admin",children:e.jsxs(u,{variant:"standard",className:"mui-form-control-admin",margin:"dense",error:!!r.errors.checkPassword,children:[e.jsx(x,{htmlFor:"my-input-password-check",children:"Nhập lại mật khẩu"}),e.jsx(b,{id:"my-input-password-check","aria-describedby":"my-helper-text",...r.getFieldProps("checkPassword")}),r.touched.checkPassword&&r.errors.checkPassword?e.jsx(f,{id:"my-helper-text",children:r.errors.checkPassword}):e.jsx(e.Fragment,{})]})}),e.jsx(m,{item:!0,lg:6,className:"mui-item-grid-admin",children:e.jsxs(u,{variant:"standard",className:"mui-form-control-admin",margin:"dense",error:!!r.errors.name,children:[e.jsx(x,{htmlFor:"my-input-name",children:"Họ tên"}),e.jsx(b,{id:"my-input-name","aria-describedby":"my-helper-text",...r.getFieldProps("name")}),r.touched.name&&r.errors.name?e.jsx(f,{id:"my-helper-text",children:r.errors.name}):e.jsx(e.Fragment,{})]})}),e.jsx(m,{item:!0,lg:6,className:"mui-item-grid-admin",children:e.jsxs(u,{variant:"standard",className:"mui-form-control-admin",margin:"dense",error:!!r.errors.email,children:[e.jsx(x,{htmlFor:"my-input-email",children:"Email"}),e.jsx(b,{id:"my-input-email","aria-describedby":"my-helper-text",...r.getFieldProps("email")}),r.touched.email&&r.errors.email?e.jsx(f,{id:"my-helper-text",children:r.errors.email}):e.jsx(e.Fragment,{})]})}),e.jsx(m,{item:!0,lg:6,className:"mui-item-grid-admin",children:e.jsxs(u,{variant:"standard",className:"mui-form-control-admin",margin:"dense",error:!!r.errors.phone,children:[e.jsx(x,{htmlFor:"my-input-phone",children:"Số điện thoại"}),e.jsx(b,{id:"my-input-phone","aria-describedby":"my-helper-text",...r.getFieldProps("phone")}),r.touched.phone&&r.errors.phone?e.jsx(f,{id:"my-helper-text",children:r.errors.phone}):e.jsx(e.Fragment,{})]})}),e.jsxs(m,{item:!0,lg:6,className:"mui-item-grid-admin",children:[e.jsxs(G,{sx:{display:"flex"},children:[e.jsx(O,{dateAdapter:B,children:e.jsx(z,{components:["DatePicker"],children:e.jsx(E,{className:"date-pick",value:s,onChange:N=>a(N)})})}),e.jsxs(u,{sx:{m:1,minWidth:90},children:[e.jsx(x,{id:"demo-controlled-open-select-label",children:"Gender"}),e.jsxs(H,{labelId:"demo-controlled-open-select-label",id:"demo-controlled-open-select",open:i,onClose:y,onOpen:S,value:o,label:"Gender",onChange:t,sx:{fontSize:"1.4rem"},children:[e.jsx(F,{value:"true",children:"Male"}),e.jsx(F,{value:"false",children:"Female"})]})]})]}),p?e.jsx(e.Fragment,{}):e.jsx(f,{id:"my-helper-text",style:{color:"red",fontSize:"1.5rem"},children:"Bạn chưa điền ngày sinh hoặc giới tính"})]})]}),e.jsxs("div",{className:"button-group-admin-register",children:[e.jsx(g,{variant:"contained",type:"submit",children:"Thêm"}),e.jsx(g,{variant:"contained",onClick:()=>{n()},children:"Hủy"})]})]})})}function ne({personData:n,closeModal:i,openUpdate:j}){const[s,a]=d.useState(n.avatar||"https://img.freepik.com/free-vector/businessman-character-avatar-isolated_24877-60111.jpg?w=1380&t=st=1688393572~exp=1688394172~hmac=815045c69ac370508646eb2d6d759a7ae12ca10a4f3e0ea6083c11c42c2617e7"),o=h=>{var c;const p=(c=h.target.files)==null?void 0:c[0];if(p){const l=new FileReader;l.onload=()=>{a(l.result)},l.readAsDataURL(p)}};return e.jsx("div",{className:"card-detail",children:e.jsxs(Y,{sx:{width:500,height:650},className:"card-wrapper",children:[e.jsx(Z,{sx:{height:300},image:s,title:`Avatar của ${n.name}`}),e.jsxs(V,{className:"mui-card-content",children:[e.jsx(R,{gutterBottom:!0,variant:"h2",component:"div",children:n.name}),e.jsxs(R,{variant:"body2",color:"text.secondary",className:"mui-typography-card",children:[e.jsx("h4",{children:"Thông tin cá nhân:"}),e.jsxs("ul",{children:[e.jsxs("li",{children:["Ngày sinh: ",e.jsx("span",{children:n.birthday})," "]}),e.jsxs("li",{children:["Email: ",e.jsx("span",{children:n.email})," "]}),e.jsxs("li",{children:["Giới tính: ",e.jsx("span",{children:n.gender?"Nam":"Nữ"})]}),e.jsxs("li",{children:["Số điện thoại: ",e.jsx("span",{children:n.phone})]}),e.jsxs("li",{children:["Mật khẩu: ",e.jsx("span",{children:n.password})]}),e.jsxs("li",{children:["Quyền: ",e.jsx("span",{children:n.role})]})]})]})]}),e.jsxs(ee,{className:"btn-group-card",children:[e.jsx(g,{size:"large",onClick:()=>{j(),i()},children:"Sửa"}),e.jsx(g,{size:"large",onClick:i,children:"Đóng"})]}),e.jsx("input",{accept:"image/*",type:"file",onChange:o,style:{display:"none"},id:"upload-photo"}),e.jsx("label",{htmlFor:"upload-photo",children:e.jsx(g,{variant:"contained",component:"span",children:"Tải lên ảnh"})})]})})}function ie({handleCloseModal:n,personData:i}){const[j,s]=d.useState(!1),[a,o]=d.useState(null),[h,p]=d.useState(),c=`${a==null?void 0:a.date()}-${((a==null?void 0:a.month())||0)+1}-${a==null?void 0:a.year()}`,l=T(),v=()=>{s(!1)},y=()=>{s(!0)},S=r=>{p(r.target.value)},t=I({initialValues:{name:`${i.name}`,email:`${i.email}`,phone:`${i.phone}`,birthday:`${i.birthday}`,role:`${i.role}`,gender:i.gender},validationSchema:U().shape({role:w().required("Role can not be empty").notOneOf(["admin","user"],"Please capitalise the role").oneOf(["ADMIN","USER","SUPERADMIN"],"Invalid Role"),name:w().matches($.nameByVietnamese,"Name has to be valid").required("Name can not be empty"),phone:q().required("Phone can not be empty")}),onSubmit:async r=>{try{const N=`${a==null?void 0:a.date()}-${((a==null?void 0:a.month())||0)+1}-${a==null?void 0:a.year()}`,k=h==="true"?!0:h==="false"?!1:"",P={...r,birthday:(a==null?void 0:a.date())!==void 0?N:i.birthday,gender:k||i.gender};console.log(P),await A.put(`/api/users/${i.id}`,P),l(K({...P,id:i.id})),C("Thành công, tài khoản đã được update!",{icon:"success"})}catch{C("Thất bại, vui lòng kiểm tra lại thông tin!",{icon:"error"})}}});return e.jsx("div",{className:"person-update-modal",children:e.jsxs("form",{action:"",className:"person-update-form",onSubmit:t.handleSubmit,children:[e.jsx("h1",{children:"Cập nhật thông tin"}),e.jsxs(m,{container:!0,spacing:2,className:"mui-grid-admin",children:[e.jsx(m,{item:!0,lg:6,className:"mui-item-grid-admin",children:e.jsxs(u,{variant:"standard",className:"mui-form-control-admin",margin:"dense",error:!!t.errors.name,children:[e.jsx(x,{htmlFor:"name",children:"Họ tên"}),e.jsx(b,{id:"name","aria-describedby":"my-helper-text",...t.getFieldProps("name")}),t.touched.name&&t.errors.name?e.jsx(f,{id:"my-helper-text",children:t.errors.name}):e.jsx(e.Fragment,{})]})}),e.jsx(m,{item:!0,lg:6,className:"mui-item-grid-admin",children:e.jsxs(u,{variant:"standard",className:"mui-form-control-admin",margin:"dense",children:[e.jsx(x,{htmlFor:"email",children:"Email"}),e.jsx(b,{id:"email","aria-describedby":"my-helper-text",disabled:!0,value:i.email})]})}),e.jsx(m,{item:!0,lg:6,className:"mui-item-grid-admin",children:e.jsxs(u,{variant:"standard",className:"mui-form-control-admin",margin:"dense",error:!!t.errors.phone,children:[e.jsx(x,{htmlFor:"phone",children:"Số điện thoại"}),e.jsx(b,{id:"phone","aria-describedby":"my-helper-text",...t.getFieldProps("phone")}),t.touched.phone&&t.errors.phone?e.jsx(f,{id:"my-helper-text",children:t.errors.phone}):e.jsx(e.Fragment,{})]})}),e.jsx(m,{item:!0,lg:6,className:"mui-item-grid-admin",children:e.jsxs(u,{variant:"standard",className:"mui-form-control-admin",margin:"dense",error:!!t.errors.role,children:[e.jsx(x,{htmlFor:"role",children:"Quyền"}),e.jsx(b,{id:"role","aria-describedby":"my-helper-text",...t.getFieldProps("role")}),t.touched.role&&t.errors.role?e.jsx(f,{id:"my-helper-text",children:t.errors.role}):e.jsx(e.Fragment,{})]})}),e.jsxs(m,{item:!0,lg:6,className:"mui-item-grid-admin",children:[e.jsx(L,{className:"birth-day",id:"filled-basic",label:"Birthday",disabled:!0,variant:"filled",value:(a==null?void 0:a.day())!==void 0?c:t.values.birthday}),e.jsxs(G,{sx:{display:"flex"},children:[e.jsx(O,{dateAdapter:B,children:e.jsx(z,{components:["DatePicker"],children:e.jsx(E,{className:"date-pick",value:a,onChange:r=>o(r)})})}),e.jsxs(u,{sx:{m:1,minWidth:90},children:[e.jsx(x,{id:"demo-controlled-open-select-label",children:"Gender"}),e.jsxs(H,{labelId:"demo-controlled-open-select-label",id:"demo-controlled-open-select",open:j,onClose:v,onOpen:y,value:h||t.values.gender,label:"Gender",onChange:S,sx:{fontSize:"1.4rem"},children:[e.jsx(F,{value:"true",children:"Male"}),e.jsx(F,{value:"false",children:"Female"})]})]})]})]})]}),e.jsxs("div",{className:"button-group-admin-register",children:[e.jsx(g,{variant:"contained",type:"submit",children:"Sửa"}),e.jsx(g,{variant:"contained",onClick:n,children:"Hủy"})]})]})})}const te=[{field:"id",headerName:"Mã",width:70,align:"center",headerAlign:"center"},{field:"name",headerName:"Tên",width:200,align:"center",headerAlign:"center"},{field:"avatar",headerName:"Hình ảnh",width:180,align:"center",headerAlign:"center",renderCell:n=>e.jsx(D,{alt:"Remy Sharp",src:n.row.avatar})},{field:"role",headerName:"Role",width:100,align:"center",headerAlign:"center"},{field:"action",headerName:"Action",width:300,sortable:!1,align:"center",headerAlign:"center",renderCell:n=>{const i=T(),[j,s]=d.useState(!1),[a,o]=d.useState(!1),h=l=>{l.stopPropagation(),s(!0)},p=l=>{l.stopPropagation(),o(!0)},c=l=>{l.stopPropagation(),C({title:"Bạn có chắc chắn muốn xóa người này?",text:"Không thể quay lại sau khi xóa",icon:"warning",buttons:["Không xóa","Xóa!"],dangerMode:!0}).then(async v=>{v?C({title:"Xóa thành công!",text:`Người dùng với id ${n.row.id} đã bị xóa`,icon:"success"}).then(async()=>{await A.delete(`/api/users?id=${n.row.id}`),i(_([n.row.id]))}):C("Hủy thành công",`Người dùng với id ${n.row.id} chưa bị xóa`,"error")})};return e.jsxs("div",{className:"button-group",children:[e.jsx(g,{variant:"contained",onClick:h,children:"Xem chi tiết"}),e.jsx(g,{variant:"contained",onClick:p,color:"info",children:"Sửa"}),e.jsx(g,{variant:"contained",onClick:c,color:"error",children:"Xóa"}),e.jsx(M,{open:j,onClose:()=>s(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsx(ne,{personData:n.row,closeModal:()=>s(!1),openUpdate:()=>o(!0)})}),e.jsx(M,{open:a,onClose:()=>o(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsx(ie,{personData:n.row,handleCloseModal:()=>o(!1)})})]})}}];function ve(){const n=T(),i=d.useRef(null),[j,s]=d.useState(!1),[a,o]=d.useState(1),[h,p]=d.useState(""),c=X(y=>y.sliceUserAdmin.currentUserbyPhanTrang),l=c.data?c.data:[];d.useEffect(()=>{n(W({pageIndex:a,keywords:h}))},[a,h]);const v=(y,S)=>{console.log(y),o(S)};return e.jsx("div",{className:"manage-user",children:e.jsxs(Q,{fixed:!0,className:"mui-container-manage",children:[e.jsx(g,{className:"button-add-admin",onClick:()=>s(!0),children:"Đăng ký quản trị viên"}),e.jsxs("div",{className:"search-user",children:[e.jsx(L,{inputRef:i,id:"outlined-basic",label:"Tìm tài khoản qua tên",variant:"outlined",className:"input-search"}),e.jsx("button",{onClick:()=>{var y;return p(((y=i.current)==null?void 0:y.value)||"")},children:"Tìm"})]}),e.jsx(M,{open:j,onClose:()=>s(!1),"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsx(se,{handleCloseModal:()=>s(!1)})}),e.jsx(re,{className:"mui-grid-user",rows:l,columns:te,checkboxSelection:!0,hideFooterPagination:!0,hideFooter:!0,sx:{fontSize:"1.4rem",height:475}}),e.jsx(ae,{onChange:v,count:Math.ceil(c.totalRow/c.pageSize),variant:"outlined",sx:{marginTop:"1rem",marginRight:"5%",justifyContent:"flex-end",display:"flex"}})]})})}export{ve as default};
